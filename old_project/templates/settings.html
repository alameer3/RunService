{% extends "base.html" %}

{% block title %}ุฅุนุฏุงุฏุงุช ูุชูุฏูุฉ - ุฎุงุฏู VNC{% endblock %}

{% block content %}
<style>
    .settings-section {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 25px;
        border-left: 5px solid #007bff;
    }
    
    .setting-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 0;
        border-bottom: 1px solid #e9ecef;
    }
    
    .setting-item:last-child {
        border-bottom: none;
    }
    
    .setting-label {
        font-weight: 500;
        color: #495057;
    }
    
    .setting-description {
        font-size: 0.9em;
        color: #6c757d;
        margin-top: 5px;
    }
    
    .form-group {
        margin-bottom: 20px;
    }
    
    .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 1em;
    }
    
    .toggle-switch {
        position: relative;
        width: 60px;
        height: 30px;
        background: #ccc;
        border-radius: 15px;
        cursor: pointer;
        transition: background 0.3s;
    }
    
    .toggle-switch.active {
        background: #007bff;
    }
    
    .toggle-slider {
        position: absolute;
        top: 3px;
        left: 3px;
        width: 24px;
        height: 24px;
        background: white;
        border-radius: 50%;
        transition: left 0.3s;
    }
    
    .toggle-switch.active .toggle-slider {
        left: 33px;
    }
</style>

<h2>โ๏ธ ุฅุนุฏุงุฏุงุช ุงููุธุงู ุงููุชูุฏูุฉ</h2>

<div class="settings-section">
    <h3>๐ง ุฅุนุฏุงุฏุงุช VNC</h3>
    
    <div class="setting-item">
        <div>
            <div class="setting-label">ุชุดุบูู ุชููุงุฆู</div>
            <div class="setting-description">ุจุฏุก ุฎุงุฏู VNC ุชููุงุฆูุงู ุนูุฏ ุชุดุบูู ุงูุชุทุจูู</div>
        </div>
        <div class="toggle-switch" onclick="toggleSetting('auto_start')">
            <div class="toggle-slider"></div>
        </div>
    </div>
    
    <div class="setting-item">
        <div>
            <div class="setting-label">ุงูุถุบุท ุงููุชูุฏู</div>
            <div class="setting-description">ุชุญุณูู ุถุบุท ุงูุจูุงูุงุช ูุชูููุฑ ุงููุทุงู ุงูุชุฑุฏุฏู</div>
        </div>
        <div class="toggle-switch active" onclick="toggleSetting('compression')">
            <div class="toggle-slider"></div>
        </div>
    </div>
    
    <div class="setting-item">
        <div>
            <div class="setting-label">ุชุณุฌูู ููุตู</div>
            <div class="setting-description">ุชุณุฌูู ุชูุตููู ูุฌููุน ุงูุนูููุงุช ูุงูุฃุฎุทุงุก</div>
        </div>
        <div class="toggle-switch" onclick="toggleSetting('verbose_logging')">
            <div class="toggle-slider"></div>
        </div>
    </div>
</div>

<div class="settings-section">
    <h3>๐ฅ๏ธ ุฅุนุฏุงุฏุงุช ุงูุนุฑุถ</h3>
    
    <div class="form-group">
        <label class="setting-label">ุฏูุฉ ุงูุดุงุดุฉ ุงูุงูุชุฑุงุถูุฉ</label>
        <select class="form-control" onchange="updateResolution(this.value)">
            <option value="1024x768">1024x768 (4:3)</option>
            <option value="1280x720">1280x720 (16:9)</option>
            <option value="1280x1024">1280x1024 (5:4)</option>
            <option value="1920x1080">1920x1080 (16:9)</option>
        </select>
    </div>
    
    <div class="form-group">
        <label class="setting-label">ุนูู ุงูุฃููุงู</label>
        <select class="form-control" onchange="updateColorDepth(this.value)">
            <option value="24">24 ุจุช (ุฃููุงู ูุงููุฉ)</option>
            <option value="16">16 ุจุช (ุฃููุงู ูุชูุณุทุฉ)</option>
            <option value="8">8 ุจุช (ุฃููุงู ูุญุฏูุฏุฉ)</option>
        </select>
    </div>
</div>

<div class="settings-section">
    <h3>๐ ุฅุนุฏุงุฏุงุช ุงูุฃูุงู</h3>
    
    <div class="form-group">
        <label class="setting-label">ุชุบููุฑ ูููุฉ ุงููุฑูุฑ</label>
        <div style="display: flex; gap: 10px;">
            <input type="password" class="form-control" id="newPassword" placeholder="ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ" style="flex: 1;">
            <button class="btn btn-primary" onclick="changePassword()">ุชุบููุฑ</button>
        </div>
    </div>
    
    <div class="setting-item">
        <div>
            <div class="setting-label">ุงูุณูุงุญ ุจุงูุงุชุตุงูุงุช ุงูุฎุงุฑุฌูุฉ</div>
            <div class="setting-description">ุงูุณูุงุญ ููุฃุฌูุฒุฉ ุฎุงุฑุฌ ุงูุดุจูุฉ ุงููุญููุฉ ุจุงูุงุชุตุงู</div>
        </div>
        <div class="toggle-switch active" onclick="toggleSetting('external_access')">
            <div class="toggle-slider"></div>
        </div>
    </div>
    
    <div class="setting-item">
        <div>
            <div class="setting-label">ูููุฉ ุงูุฌูุณุฉ</div>
            <div class="setting-description">ุฅููุงุก ุงูุฌูุณุฉ ุชููุงุฆูุงู ุจุนุฏ ุนุฏู ุงููุดุงุท (ุฏูุงุฆู)</div>
        </div>
        <input type="number" class="form-control" value="60" min="5" max="300" style="width: 100px;" onchange="updateSessionTimeout(this.value)">
    </div>
</div>

<div class="settings-section">
    <h3>๐ ุฅุนุฏุงุฏุงุช ุงูุดุจูุฉ</h3>
    
    <div class="form-group">
        <label class="setting-label">ูููุฐ VNC</label>
        <input type="number" class="form-control" value="5900" min="5900" max="5999" onchange="updateVncPort(this.value)">
        <small class="setting-description">ุงููููุฐ ุงููุณุชุฎุฏู ูุฎุงุฏู VNC (5900-5999)</small>
    </div>
    
    <div class="setting-item">
        <div>
            <div class="setting-label">IPv6 ุฏุนู</div>
            <div class="setting-description">ุชูููู ุฏุนู ุจุฑูุชูููู IPv6</div>
        </div>
        <div class="toggle-switch" onclick="toggleSetting('ipv6_support')">
            <div class="toggle-slider"></div>
        </div>
    </div>
</div>

<div class="settings-section">
    <h3>๐ ุฅุนุฏุงุฏุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู</h3>
    
    <div class="setting-item">
        <div>
            <div class="setting-label">ูุณุฎ ุงุญุชูุงุทู ุชููุงุฆู</div>
            <div class="setting-description">ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ููุฅุนุฏุงุฏุงุช ููููุงู</div>
        </div>
        <div class="toggle-switch" onclick="toggleSetting('auto_backup')">
            <div class="toggle-slider"></div>
        </div>
    </div>
    
    <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button class="btn btn-success" onclick="exportSettings()">๐ค ุชุตุฏูุฑ ุงูุฅุนุฏุงุฏุงุช</button>
        <button class="btn btn-warning" onclick="importSettings()">๐ฅ ุงุณุชูุฑุงุฏ ุงูุฅุนุฏุงุฏุงุช</button>
        <button class="btn btn-danger" onclick="resetSettings()">๐ ุฅุนุงุฏุฉ ุชุนููู</button>
    </div>
</div>

<div style="text-align: center; margin-top: 30px;">
    <button class="btn btn-primary" onclick="saveAllSettings()">๐พ ุญูุธ ุฌููุน ุงูุฅุนุฏุงุฏุงุช</button>
    <a href="/dashboard" class="btn btn-secondary">โฉ๏ธ ุงูุนูุฏุฉ ูููุญุฉ ุงูุชุญูู</a>
</div>

<script>
function toggleSetting(settingName) {
    const toggle = event.target.closest('.toggle-switch');
    toggle.classList.toggle('active');
    
    const isActive = toggle.classList.contains('active');
    console.log(`Setting ${settingName}: ${isActive}`);
    
    // Save setting to backend
    fetch('/admin/update-setting', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({setting: settingName, value: isActive})
    });
}

function updateResolution(resolution) {
    fetch('/admin/change-resolution', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({resolution: resolution})
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('ุชู ุชุญุฏูุซ ุฏูุฉ ุงูุดุงุดุฉ ุจูุฌุงุญ');
        } else {
            alert('ูุดู ูู ุชุญุฏูุซ ุฏูุฉ ุงูุดุงุดุฉ: ' + data.message);
        }
    });
}

function updateColorDepth(depth) {
    console.log('Color depth updated to:', depth);
    // Implement color depth update
}

function changePassword() {
    const newPassword = document.getElementById('newPassword').value;
    if (newPassword.length < 6) {
        alert('ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชููู 6 ุฃุญุฑู ุนูู ุงูุฃูู');
        return;
    }
    
    fetch('/admin/change-password', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({password: newPassword})
    })
    .then(response => response.json())
    .then(data => {
        alert(data.message);
        if (data.success) {
            document.getElementById('newPassword').value = '';
        }
    });
}

function updateSessionTimeout(timeout) {
    console.log('Session timeout updated to:', timeout);
    // Implement session timeout update
}

function updateVncPort(port) {
    if (port < 5900 || port > 5999) {
        alert('ุงููููุฐ ูุฌุจ ุฃู ูููู ุจูู 5900-5999');
        return;
    }
    console.log('VNC port updated to:', port);
    // Implement VNC port update
}

function exportSettings() {
    window.open('/admin/export-settings', '_blank');
}

function importSettings() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    input.onchange = function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const settings = JSON.parse(e.target.result);
                    // Import settings logic
                    alert('ุชู ุงุณุชูุฑุงุฏ ุงูุฅุนุฏุงุฏุงุช ุจูุฌุงุญ');
                } catch (err) {
                    alert('ุฎุทุฃ ูู ููู ุงูุฅุนุฏุงุฏุงุช');
                }
            };
            reader.readAsText(file);
        }
    };
    input.click();
}

function resetSettings() {
    if (confirm('ูู ุชุฑูุฏ ุฅุนุงุฏุฉ ุชุนููู ุฌููุน ุงูุฅุนุฏุงุฏุงุช ููููู ุงูุงูุชุฑุงุถูุฉุ')) {
        fetch('/admin/reset-settings', {method: 'POST'})
        .then(response => response.json())
        .then(data => {
            alert(data.message);
            if (data.success) {
                window.location.reload();
            }
        });
    }
}

function saveAllSettings() {
    alert('ุชู ุญูุธ ุฌููุน ุงูุฅุนุฏุงุฏุงุช ุจูุฌุงุญ');
}
</script>
{% endblock %}